description "FUSE filesystem for LXC"
author "St√©phane Graber <stgraber@ubuntu.com>"

start on starting lxc or cgmanager-ready
stop on runlevel [06]

respawn

pre-start script
    [ ! -d /var/lib/lxcfs/proc ] || { stop; exit 0; }
end script

exec /usr/bin/lxcfs -s -f -o allow_other /var/lib/lxcfs

post-stop script
    # Cleanup in case of crash
    fusermount -u /var/lib/lxcfs 2> /dev/null || true
    [ -L /etc/mtab ] || \
        sed -i "/^lxcfs \/var\/lib\/lxcfs fuse.lxcfs/d" /etc/mtab
end script
